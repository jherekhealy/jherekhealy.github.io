<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>About the cover: implied volatility fractals! | Jherek Healy</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="As you will have probably already noticed, the front and back pictures of my book are fractals. But they are not just any fractal.
They are generated by coloring the number of iterations needed to solve the implied volatility of a vanilla option of a given price in the complex plane, using
a root finding algorithm like Newton&rsquo;s method or Householder&rsquo;s method.
Each point corresponds to a complex implied volatility guess and the more iterations needed, the darker is the point.">
    <meta name="generator" content="Hugo 0.147.8">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="https://jherekhealy.github.io/posts/about_the_cover_implied_volatility_fractals/">
    

    <meta property="og:url" content="https://jherekhealy.github.io/posts/about_the_cover_implied_volatility_fractals/">
  <meta property="og:site_name" content="Jherek Healy">
  <meta property="og:title" content="About the cover: implied volatility fractals!">
  <meta property="og:description" content="As you will have probably already noticed, the front and back pictures of my book are fractals. But they are not just any fractal. They are generated by coloring the number of iterations needed to solve the implied volatility of a vanilla option of a given price in the complex plane, using a root finding algorithm like Newton’s method or Householder’s method. Each point corresponds to a complex implied volatility guess and the more iterations needed, the darker is the point.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">

  <meta itemprop="name" content="About the cover: implied volatility fractals!">
  <meta itemprop="description" content="As you will have probably already noticed, the front and back pictures of my book are fractals. But they are not just any fractal. They are generated by coloring the number of iterations needed to solve the implied volatility of a vanilla option of a given price in the complex plane, using a root finding algorithm like Newton’s method or Householder’s method. Each point corresponds to a complex implied volatility guess and the more iterations needed, the darker is the point.">
  <meta itemprop="wordCount" content="521">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="About the cover: implied volatility fractals!">
  <meta name="twitter:description" content="As you will have probably already noticed, the front and back pictures of my book are fractals. But they are not just any fractal. They are generated by coloring the number of iterations needed to solve the implied volatility of a vanilla option of a given price in the complex plane, using a root finding algorithm like Newton’s method or Householder’s method. Each point corresponds to a complex implied volatility guess and the more iterations needed, the darker is the point.">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  <header class="cover bg-top" style="background-image: url('https://jherekhealy.github.io/images/iv_fractals.png');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://jherekhealy.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Jherek Healy
    </a>
    <div class="flex-l items-center">
      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="Articles page">
              Articles
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://quantsrus.github.io/" title="Blog page">
              Blog
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/citing/" title="Citing page">
              Citing
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/erratum/" title="Erratum page">
              Erratum
            </a>
          </li>
          
          
           <li class="list f5 f4-ns fw4 dib pr3">
<script type="text/javascript">document.write('<a class="hover-white no-underline white-90"  href="mail' + 'to:' + new Array("jherekhealy","protonmail.com").join("@") + '?subject=your%20book">'  +  "Contact</a>");</script> 
          </li>
            
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://twitter.com/JherekHealy" target="_blank" rel="noopener" class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">About the cover: implied volatility fractals!</div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Articles
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
      
      <a href="https://twitter.com/intent/tweet?url=https://jherekhealy.github.io/posts/about_the_cover_implied_volatility_fractals/&amp;text=About%20the%20cover:%20implied%20volatility%20fractals!" class="ananke-social-link twitter no-underline" aria-label="share on Twitter">
        
        <span class="icon"> <svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
        
      </a>
    
  </div>


      <h1 class="f1 athelas mt3 mb1">About the cover: implied volatility fractals!</h1>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>As you will have probably already noticed, the front and back pictures of <a href="https://www.amazon.com/dp/B0CM9TL63J">my book</a> are fractals. But they are not just any fractal.
They are generated by coloring the number of iterations needed to solve the implied volatility of a vanilla option of a given price in the complex plane, using
a root finding algorithm like <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton&rsquo;s method</a> or <a href="https://en.wikipedia.org/wiki/Householder%27s_method">Householder&rsquo;s method</a>.
Each point corresponds to a complex implied volatility guess and the more iterations needed, the darker is the point.</p>
<p>Of course, in reality, the only interesting part would be the positive real line, but the full complex plane makes for pretty graphs. I was very
excited the first time I had this idea and saw the pretty pictures it produced. After writing the book, I noticed that someone else had though
of plotting those fractals before me. The paper <a href="https://arxiv.org/abs/1612.01951">Stability of calibration procedures: fractals in the Black-Scholes model</a> was published on arxiv
end of December 2016, only a couple of months before my own experiments. What a coincidence!</p>
<p>I detail exactly the steps I used in the appendix C of the book, including how to generate a smooth gradient, inspired by the technique of <a href="https://www.chiark.greenend.org.uk/~sgtatham/newton/">Simon Tatham</a>. The book also contains sample code in Octave. Below you will find the Newton fractal for the implied volatility of an out-of-the money call of strike K=exp(-1) and maturity 1 year with value 0.1269. This specific option value corresponds to an implied volatility of 100%. The point at absissa 1.0 has thus a white color, as the initial guess corresponds to the true value, and no iteration is necessary then. Darker colors means more iterations and the black color means that Newton&rsquo;s method failed to converge. The fractal is computed using <a href="https://developer.mozilla.org/en-US/docs/WebAssembly">Webassembly</a>, on your computer.</p>


Left corner abscissa: <input type="number" value="-2.6667" id="x" style="width: 8em;" />, ordinate: <input type="number" value="-2.0000" id="y" style="width: 8em;">,

diameter <input type="number" value="5.3333" id="diameter" style="width: 8em;" /><input type="button" value="Render" onClick="javascript:renderCanvas();" /><br />
  <canvas id="canvas" class="canvas" width="640" height="480"></canvas>
  <script src="/fractal.js"></script>
  <script src="/fractal_canvas.js"></script>
 

<p>The corresponding C code for the fractal iteration is
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">double</span> <span style="color:#a6e22e">iterateEquation</span>(<span style="color:#66d9ef">double</span> u0, <span style="color:#66d9ef">double</span> v0, <span style="color:#66d9ef">int</span> maxiterations) {
</span></span><span style="display:flex;"><span>  cmplx b <span style="color:#f92672">=</span> C(u0,v0);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Tuple</span> fbt <span style="color:#f92672">=</span> f(b);
</span></span><span style="display:flex;"><span>  cmplx fb <span style="color:#f92672">=</span> fbt.v; cmplx fa <span style="color:#f92672">=</span> fbt.v;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> ftol <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-8</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iterations <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  cmplx a <span style="color:#f92672">=</span> b;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (std<span style="color:#f92672">::</span>abs(fb) <span style="color:#f92672">&gt;</span> ftol) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (iterations <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; iterations <span style="color:#f92672">&lt;</span> maxiterations; iterations<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      cmplx x0 <span style="color:#f92672">=</span> b; cmplx x1 <span style="color:#f92672">=</span> x0;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (fbt.dv <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0.</span>) {
</span></span><span style="display:flex;"><span>        x1 <span style="color:#f92672">-=</span> fb <span style="color:#f92672">/</span> fbt.dv;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      a <span style="color:#f92672">=</span> x0; fa <span style="color:#f92672">=</span> fb;
</span></span><span style="display:flex;"><span>      fbt <span style="color:#f92672">=</span> f(x1);
</span></span><span style="display:flex;"><span>      fb <span style="color:#f92672">=</span> fbt.v; b <span style="color:#f92672">=</span> x1;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (isnan(creal(fb)) <span style="color:#f92672">||</span> isnan(cimag(fb)) <span style="color:#f92672">||</span> isinf(creal(fb)) <span style="color:#f92672">||</span> isinf(cimag(fb))) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1.0</span><span style="color:#f92672">*</span>maxiterations;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (std<span style="color:#f92672">::</span>abs(fb) <span style="color:#f92672">&lt;=</span> ftol) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (isnan(creal(fb)) <span style="color:#f92672">||</span> isnan(cimag(fb)) <span style="color:#f92672">||</span> isinf(creal(fb)) <span style="color:#f92672">||</span> isinf(cimag(fb))
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">||</span>isnan(creal(fa)) <span style="color:#f92672">||</span> isnan(cimag(fa)) <span style="color:#f92672">||</span> isinf(creal(fa)) <span style="color:#f92672">||</span> isinf(cimag(fa))) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1.0</span><span style="color:#f92672">*</span>maxiterations;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> afa <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>abs(fa);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (afa <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1e-16</span>){
</span></span><span style="display:flex;"><span>    afa <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-16</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> afb <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>abs(fb);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (afb <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1e-16</span>) {
</span></span><span style="display:flex;"><span>    afb <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-16</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> zmag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (afb <span style="color:#f92672">&lt;=</span> ftol <span style="color:#f92672">&amp;&amp;</span> afa <span style="color:#f92672">!=</span> afb) {
</span></span><span style="display:flex;"><span>    zmag <span style="color:#f92672">=</span> (log(ftol) <span style="color:#f92672">-</span> log(afa)) <span style="color:#f92672">/</span> (log(afb) <span style="color:#f92672">-</span> log(afa));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">double</span> mu <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span><span style="color:#f92672">*</span>iterations <span style="color:#f92672">+</span> zmag;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> mu;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
The Faddeeva function, used to compute the cumulative normal distribution in the complex space, comes from <a href="http://ab-initio.mit.edu/wiki/index.php/Faddeeva_Package">Steven Johnson library</a>. The full source code for the implied volatility fractal is <a href="/fractal.cc">here</a>.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://jherekhealy.github.io/" >
    &copy;  Jherek Healy 2025 
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://twitter.com/JherekHealy" target="_blank" rel="noopener" class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
